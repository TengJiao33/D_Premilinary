
> **Team Strategy Overview**
> 本文档详细说明了我们在本次 MCM 竞赛中使用的数学模型、算法逻辑及代码实现流程。我们的核心策略是建立一个**“拓扑约束感知 (Topology-Aware)”**的动态调度系统，在保证环境正义 (Environmental Justice) 的前提下最大化运营效率。

---

## 🚀 快速开始 (Execution Order)

由于各模块之间存在数据依赖（Data Dependency），请严格按照以下顺序运行脚本：

1.  **`solve1.py`** : 生成核心排班方案及基础解文件 `problem1_final_solution.csv`。
2.  **`problem1_visualization_updated.py`** (Visualization Bridge): 读取基础解，生成含每日排班详情的增强数据 `problem1_rich_solution.csv`，并绘制 Q1 核心图表。
3.  **`solve2.py`** : 读取 Q1 结果，评估公平性与效率指标。
4.  **`solve3.py`** : 读取 Q1 结果，进行压力测试与灵敏度分析。
5.  **`solve4.py`** : 制定晚间回收策略，输出策略表 `problem4_strategy_result.csv`。
6.  **`temp.py`** : **[独立运行]** 用于预处理 `MN.csv` (NYC Building Data)，计算各社区真实的小楼比例字典。
7.  **`solve5.py`** : 引入 `temp.py` 挖掘出的真实建筑数据，评估垃圾桶新政影响，输出最终预测 `problem5_real_data_result.csv`。

---

## 🛠️ 模型详解 (Methodology by Problem)

### Problem 1: 资源分配 (Resource Allocation)
**核心模型：L5 拓扑约束优化模型 (L5 Topology-Constrained Optimization)**

* **目标：** 确定全曼哈顿所需的最小车队规模。
* **策略：**
    * **频率决策 (Frequency Decision):** 基于鼠患投诉量 (Rat Complaints) 将社区分为高频区 (3次/周) 和标准区 (2次/周)。
    * **拓扑约束 (Topology Constraints):** 为了模拟现实运营，我们将曼哈顿划分为三个相邻的资源池 (Lower, Midtown, Uptown)。卡车只能在池内共享，禁止跨池长距离调度。
    * **效率参数 ($C_{eff}$):** 设定 20% 的效率损耗 (Traffic/Deadhead)，单车有效日运力为 $19.2$ 吨。
    * **算法：** 使用 **Greedy Load Balancing (贪心负载均衡)** 算法实现错峰排班。
* **结果：** 推荐车队规模 **142 辆** (对比基准 190 辆，节省 25%)。这为后续的公平性策略提供了预算基础。

### Problem 2: 评估与公平性 (Evaluation & Equity)
**核心指标：环境正义评价体系 (Environmental Justice Metrics)**

* **目标：** 量化 Q1 策略的公平性。
* **指标：**
    * **收入相关性 (Income Correlation):** 计算服务频率与家庭收入的 Pearson 相关系数。结果为 **-0.523**，证明策略具有强烈的**进步主义 (Progressive)** 特征（向低收入区倾斜）。
    * **鼠患响应度 (Rat Responsiveness):** 相关系数 **0.794**，证明资源分配严格按需进行 (Effective)。
    * **基尼系数 (Gini Index):** 服务分配基尼系数仅为 **0.192**，实现了高度均衡。
* **可视化：** `Viz_Q2_Tradeoff.png` 展示了 L5 模型在效率与公平之间的最佳平衡。

### Problem 3: 鲁棒性分析 (Disruption Scenarios)
**核心方法：压力测试模拟 (Stress Testing Simulation)**

* **目标：** 测试系统在车辆故障或垃圾激增下的稳定性。
* **发现：**
    * **内在鲁棒性 (Intrinsic Buffer):** 由于 Q1 预留了 20% 的效率缓冲，系统可直接承受 **26.5%** 的垃圾激增而无需调整。
    * **适应性策略 (Adaptive Protocol):** 在极端灾难（>30% 激增）下，启动加班模式 ($R=2.5$ trips/day) 可承受高达 **50%** 的冲击。

### Problem 4: 鼠患治理 - 时间维度 (Temporal Strategy)
**核心策略：晚间回收 (Evening Pickup)**

* **数据洞察：** 发现垃圾总量与鼠患的相关性仅为 $r=0.385$，证明单纯减少垃圾量无效，必须切断**暴露时间 (Exposure Time)**。
* **决策：** 将 6 个高风险区划为“晚间回收区”，将垃圾路边暴露时间从 12 小时压缩至 4 小时。
* **预测：** 预计全城鼠患投诉量减少 **25.7%**。

### Problem 5: 垃圾桶新政 - 空间维度 (Spatial Strategy)
**核心数据：NYC PLUTO Building Inventory (2021)**

* **数据挖掘 (`temp.py`):** 通过挖掘 2021 年真实建筑数据，发现曼哈顿虽然人口密度大，但 **60%-70% 的建筑物是适合用桶的小楼 (1-9 Units)**。
* **双重影响模型 (`solve5.py`):**
    * **物流 (Logistics):** 约 35% 的停靠点实现机械化，车队规模进一步优化至 **137 辆** (再省 5 辆)。
    * **卫生 (Hygiene):** 由于大型公寓楼（主要垃圾源）无法用桶，物理隔绝带来的鼠患减少率为 **13.3%**。
* **综合结论：** 必须结合 Q4 (针对大楼的时间策略) 和 Q5 (针对小楼的空间策略)，才能实现 ~40% 的总治鼠效果。

---

## 📂 文件清单 (File Structure)

### 核心代码 (Core Solvers)
* `solve1.py`: **[Main Solver]** Q1 主优化器，负责生成排班和计算车队规模 (L4/L5)。
* `solve2.py`: **[Evaluator]** Q2 评估脚本，生成公平性散点图和权衡图。
* `solve3.py`: **[Simulator]** Q3 压力测试脚本，生成鲁棒性热力图。
* `solve4.py`: **[Predictor]** Q4 策略脚本，预测晚间回收对老鼠的影响。
* `solve5.py`: **[Policy Analyzer]** Q5 政策分析脚本，整合真实数据评估垃圾桶政策。

### 数据处理与辅助 (Utilities)
* `temp.py`: **[Data Miner]** 用于处理原始 `MN.csv` 建筑数据，计算各区真实的小楼比例 (Bin Adoption Rate)。
* `problem1_visualization_updated.py`: **[Visualizer]** 桥接脚本，用于生成 Q1 的可视化图表。

### 结果数据 (Key Outputs)
* `problem1_final_solution.csv`: **[Q1 Base Output]** 包含频率、垃圾量、车队需求的基础解文件。
* `problem1_rich_solution.csv`: **[Visualization Data]** **(新增)** 包含 Mon-Sun 详细排班表的增强数据，专供可视化代码（如地图绘制）使用。
* `problem4_strategy_result.csv`: **[Q4 Output]** 包含各区早/晚班分配建议及老鼠预测结果。
* `problem5_real_data_result.csv`: **[Q5 Output]** 包含基于真实建筑数据的最终车队与老鼠影响预测。

### 关键图表 (Visualizations)
* `Viz_*.png`: 各步骤生成的关键图表，用于论文插图。

---

> **Note to Team:**
> 所有模型均基于 **"Reality-First" (现实优先)** 原则构建。我们没有追求数学上的理论极限 (113 辆)，而是选择了包含拓扑约束和效率损耗的现实最优解 (142 辆)。这一选择使得我们的后续分析（公平性、鲁棒性）具有了坚实的物质基础。